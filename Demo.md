# Apache Maven Release Plugin Demo

## Prepare

Export new value environment variable `ARTIFACT_REPO` with the dedicated path
for the artifact repository.

Export new value environment variable `LOCAL_GIT_REPO` with the dedicated path
for the local repository.

Export value environment variable `REMOTE_GIT_REPO` with the dedicated path
for the remote repository.

Create a directory to represent an artifact repository

```sh
mkdir "${ARTIFACT_REPO:-/tmp/deploy}"
```

Clone repo representing a shared repository in the demo

```sh
git clone --bare -b maven_release_plugin https://github.com/capybara1/ReleaseDemo.git "${REMOTE_GIT_REPO:-/tmp/remote.git}"
```

Clone again to represent a local repository in the demo

```sh
git clone  "${REMOTE_GIT_REPO:-/tmp/remote.git}" "${LOCAL_GIT_REPO:-/tmp/local}"
```

Change to `/tmp/local`

```sh
cd  "${LOCAL_GIT_REPO:-/tmp/local}"
```

## Perform

Have a look at the version

```sh
mvn help:evaluate -Dexpression=project.version -q -DforceStdout
```

Perform a release

```sh
./mvn.sh --batch-mode conventional-commits:version release:prepare release:perform
```

Have a look at the version

```sh
./mvn.sh help:evaluate -Dexpression=project.version -q -DforceStdout
```

Have a look at the intermediate files, generated by the plugin

```sh
cat target/version.props | grep developmentVersion | cut -d'=' -f2
cat target/version.props | grep releaseVersion | cut -d'=' -f2
```
